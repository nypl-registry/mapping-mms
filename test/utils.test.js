/* global describe, it */

'use strict'
var assert = require('assert') // eslint-disable-line
var should = require('should') // eslint-disable-line
var mapUtils = require('../lib/utils.js')

describe('mapUtils lib/utils.js', function () {
  it('it should compare mms and archives titles for a callnumber match and return the best or no match', function () {
    var noMatch = {'mmsCollection': {'_id': '8efcea80-c607-012f-fa22-58d385a7bc34', 'mmsDb': '27978', 'mmsType': 'Collection', 'mmsUuid': '8efcea80-c607-012f-fa22-58d385a7bc34', 'dates': [{'field': 'dateCreated', 'type': 'w3cdtf', 'value': '1880', 'keyDate': 'yes', 'point': 'start', 'encoding': false}, {'field': 'dateCreated', 'type': 'w3cdtf', 'value': '1950', 'keyDate': false, 'point': 'end', 'encoding': false}], 'title': 'Joe Laurie, Jr. papers, 1880-1950.', 'originInfo': '18801950', 'dateCreated': '1950', 'hades': '1943799', 'bNumber': 'b16514437', 'catnyp': 'b8506521', 'oclc': 'NYPW96-A171', 'callNumber': '8-MWEZ', 'sourceSystem': 'mms', 'rightsAgents': false, 'agents': [{'namePart': 'Laurie, Joe (1893-1954)', 'type': 'personal', 'authority': 'naf', 'valueURI': false, 'usage': false, 'role': ['http://id.loc.gov/vocabulary/relators/col']}], 'subjects': [], 'divisions': ['THE'], 'notes': [{'type': 'ownership', 'text': '1.1\\a 1996 30 lin. ft.'}, {'type': 'content', 'text': 'Joe Laurie, Jr., star of vaudeville, radio and television.'}, {'type': 'content', 'text': "The Joe Laurie, Jr. papers contain original art work, posters, photographs, programs, clippings, scripts and sketches, manuscripts and correspondence and document Joe Laurie's career in vaudeville, radio and television."}, {'type': 'ownership', 'text': 'THE Mss'}], 'titles': [{'primary': true, 'title': 'Joe Laurie, Jr. papers, 1880-1950.', 'subTitle': false, 'partName': false, 'partNumber': false, 'supplied': 'no', 'lang': 'eng', 'script': false, 'type': false, 'authority': false}], 'languages': [], 'typeOfResource': [], 'abstracts': [], 'genres': [], 'physicalDescriptions': [{'form': [], 'extent': ['30 lf.>']}], 'originInfos': [{'place': [], 'publisher': []}]}, 'archivesCollections': [{'_id': 3596, 'title': 'L. B. Wilson papers', 'mssDb': 3596, 'mss': 21755, 'bNumber': 'b16135365', 'callNumber': '8-MWEZ', 'divisions': 'THE', 'type': 'Collection', 'agents': [{'id': 36813, 'namePart': 'Wilson, L. B.', 'type': 'persname', 'authority': 'naf', 'role': 'originator', 'valueURI': 'http://viaf.org/viaf/191926671'}], 'subjects': [], 'notes': [{'type': false, 'text': '<p>Card catalog available.</p>'}], 'languages': [], 'dates': [], 'abstracts': []}, {'_id': 4212, 'title': 'Maurice Zolotow papers', 'mssDb': 4212, 'mss': 21752, 'bNumber': 'b16135358', 'callNumber': '8-MWEZ', 'divisions': 'THE', 'type': 'Collection', 'agents': [{'id': 36966, 'namePart': 'Zolotow, Maurice', 'type': 'persname', 'authority': false, 'role': 'originator', 'valueURI': false}, {'id': 17156, 'namePart': 'Fontanne, Lynn', 'type': 'persname', 'authority': 'naf', 'role': 'contributor', 'valueURI': false}, {'id': 17157, 'namePart': 'Lunt, Alfred.', 'type': 'persname', 'authority': 'naf', 'role': 'contributor', 'valueURI': false}], 'subjects': [], 'notes': [{'type': 'scopecontent', 'text': '<p>Materials regarding Alfred Lunt and Lynn Fontanne.</p>'}, {'type': false, 'text': '<p>Papers closed for processing</p>'}], 'languages': [], 'dates': [], 'abstracts': [' Materials regarding Alfred Lunt and Lynn Fontanne.']}, {'_id': 5781, 'title': 'Stark Young correspondence', 'mssDb': 5781, 'mss': 21754, 'bNumber': 'b16135364', 'callNumber': '8-MWEZ', 'divisions': 'THE', 'type': 'Collection', 'agents': [{'id': 20441, 'namePart': 'Young, Stark, 1881-1963', 'type': 'persname', 'authority': 'naf', 'role': 'originator', 'valueURI': 'http://viaf.org/viaf/25406862'}], 'subjects': [], 'notes': [{'type': 'scopecontent', 'text': '<p>Correspondence regarding the life and career of playwright, Stark Young.</p>'}, {'type': false, 'text': '<p>Card catalog available.</p>'}], 'languages': [], 'dates': [], 'abstracts': [' Correspondence regarding the life and career of playwright, Stark Young.']}]}
    var shouldMatch = {'mmsCollection': {'_id': 'ef6d26f0-c760-0132-f87d-58d385a7bbd0','mmsDb': '41878','mmsType': 'Collection','mmsUuid': 'ef6d26f0-c760-0132-f87d-58d385a7bbd0','dates': [],'title': 'Anne Nichols papers, 1873-1965.','tmsId': '21586','callNumber': '*T-Mss 2001-012','sourceSystem': 'mms','rightsAgents': false,'agents': [],'subjects': [],'divisions': ['THE'],'notes': [],'titles': [{'primary': true,'title': 'Anne Nichols papers, 1873-1965.','subTitle': false,'partName': false,'partNumber': false,'supplied': false,'lang': false,'script': false,'type': false,'authority': false}],'languages': [],'typeOfResource': [],'abstracts': [],'genres': [],'physicalDescriptions': [{'form': [],'extent': ['1.42 linear feet.']}],'originInfos': []},'archivesCollections': [{'_id': 416,'title': 'Anne Nichols papers','dateStatement': '1873-1965','mssDb': 416,'mss': 21586,'bNumber': 'b15243207','callNumber': '*T-Mss 2001-012','divisions': 'THE','type': 'Collection','agents': [{'id': 6430,'namePart': 'Nichols, Anne, 1891-1966','type': 'persname','authority': 'naf','role': 'originator','valueURI': 'http://viaf.org/viaf/92280820'}, {'id': 6431,'namePart': 'Lignemare, William de','type': 'persname','authority': 'naf','role': 'contributor','valueURI': false}],'subjects': [{'id': 3267,'type': 'genreform','nameType': 'genreform','authority': 'ftamc','valueURI': false,'text': 'Correspondence'}, {'id': 6433,'type': 'topic','nameType': 'subject','authority': 'lcsh','valueURI': false,'text': 'Motion pictures -- United States'}, {'id': 3154,'type': 'topic','nameType': 'subject','authority': 'lcsh','valueURI': false,'text': 'Theater -- New York (State) -- New York'}, {'id': 6432,'type': 'topic','nameType': 'subject','authority': 'lcsh','valueURI': false,'text': 'Women dramatists, American -- United States'}],'notes': [{'type': 'bioghist','text': "<p>Anne Nichols was a playwright best known for the highly successful comedy ABIE'S IRISH ROSE, which opened on Broadway in 1922, ran for five years, and inspired two movies and a radio series. Born in Dales Mill, Georgia, in 1891, Anne Nichols became an actress as a teenager and appeared on stage and in two early silent movies by the age of 20. Her first full-length work as a playwright was HEARTS DESIRE, written with Adelaide Matthews, with whom Nichols also co-authored JUST MARRIED (1922). Writing alone, Nichols provided the libretto for the musical LOVE DREAMS (1921). ABIE'S IRISH ROSE, a comedy about the romance between an Irish girl and a Jewish boy and the inter-family clash that results, received poor reviews from most critics when it opened in 1922, but audiences loved it, and kept the play running for over 2,300 performances until October 1927. A silent film adaptation starring Buddy Rogers was released in 1929, and a sound version, produced by Bing Crosby, in 1946. The premise was also adapted into a radio series, which ran from 1942 to 1944. Anne Nichols wrote several other plays and directed as well, and later managed property for the Actors' Fund. She died in Englewood Cliffs, New Jersey, on September 15, 1966, at the age of 74.</p>"}, {'type': 'scopecontent','text': "<p>The Anne Nichols papers contain correspondence and writings documenting a portion of her career, with the emphasis on ABIE'S IRISH ROSE. Other materials include legal files dealing with the will of William de Lignemare. There are also files and correspondence dealing with property belonging to the Actors' Fund that Anne Nichols managed for them.</p>"}],'languages': [],'dates': [{'field': 'inclusive','type': false,'value': 1873,'keyDate': false,'point': 'start','encoding': false}, {'field': 'inclusive','type': false,'value': 1965,'keyDate': false,'point': 'end','encoding': false}, {'field': 'exact','type': false,'value': '1873','keyDate': true,'point': false,'encoding': false}],'abstracts': ["Anne Nichols was a playwright best known for the highly successful comedy ABIE'S IRISH ROSE, which opened on Broadway in 1922, ran for five years, and inspired two movies and a radio series. Born in Dales Mill, Georgia, in 1891, Anne Nichols became an actress as a teenager and appeared on stage and in two early silent movies by the age of 20. Her first full-length work as a playwright was HEARTS DESIRE, written with Adelaide Matthews, with whom Nichols also co-authored JUST MARRIED (1922). Writing alone, Nichols provided the libretto for the musical LOVE DREAMS (1921). ABIE'S IRISH ROSE, a comedy about the romance between an Irish girl and a Jewish boy and the inter-family clash that results, received poor reviews from most critics when it opened in 1922, but audiences loved it, and kept the play running for over 2,300 performances until October 1927. A silent film adaptation starring Buddy Rogers was released in 1929, and a sound version, produced by Bing Crosby, in 1946. The premise was also adapted into a radio series, which ran from 1942 to 1944. Anne Nichols wrote several other plays and directed as well, and later managed property for the Actors' Fund. She died in Englewood Cliffs, New Jersey, on September 15, 1966, at the age of 74. The Anne Nichols papers contain correspondence and writings documenting a portion of her career, with the emphasis on ABIE'S IRISH ROSE. Other materials include legal files dealing with the will of William de Lignemare. There are also files and correspondence dealing with property belonging to the Actors' Fund that Anne Nichols managed for them."]}, {'_id': 10056,'title': 'Anne Nichols papers, Additions','dateStatement': '1925-1955 [bulk 1940s-1955]','mssDb': 10056,'mss': 22679,'bNumber': 'b20792774','callNumber': '*T-Mss 2001-012','divisions': 'THE','type': 'Collection','agents': [{'id': 190411,'namePart': 'Nichols, Anne, 1891-1966','type': 'persname','authority': 'naf','role': 'creator','valueURI': false}],'subjects': [{'id': 4429,'type': 'genreform','nameType': 'genreform','authority': 'aat','valueURI': false,'text': 'Letters (correspondence)'}, {'id': 6266,'type': 'genreform','nameType': 'genreform','authority': 'aat','valueURI': false,'text': 'Sheet music'}, {'id': 159831,'type': 'genreform','nameType': 'genreform','authority': 'aat','valueURI': false,'text': 'Writings (document genre)'}, {'id': 3154,'type': 'topic','nameType': 'subject','authority': 'lcsh','valueURI': false,'text': 'Theater -- New York (State) -- New York'}, {'id': 15038,'type': 'topic','nameType': 'occupation','authority': 'lcsh','valueURI': false,'text': 'Women dramatists'}],'notes': [{'type': 'bioghist','text': "<p>Anne Nichols (1891-1966) was an American playwright. Throughout her career she wrote several plays, but she was best known for her successful comedy Abie's Irish Rose. The comedy opened on Broadway in 1922 and ran until 1927 with over 2300 performances. It later inspired two film adaptations and a radio series. The stage production of Abie's Irish Rose saw a resurgence in the 1940s.</p>"}, {'type': 'scopecontent','text': "<p>The Anne Nichols papers, Additions date from 1925 to 1955 (bulk dates 1940s-1955) and contain clippings, photographs, programs, writings, letters, sheet music, and recordings.</p> <p>The bulk of the collection relates to the 1944 resurgence of Nichols' play Abie's Irish Rose during its 22nd anniversary. The programs, photographs, and clippings document the numerous productions across the country in cities such as Los Angeles, Detroit, Chicago, Boston, and New York City.</p> <p>The collection also reflects Nichols' interest in writing both a musical and an autobiography. Materials related to the development of a musical include a copy of “It's the Little Things that Count” written by Nichols and Adelaide Matthews. This verse is accompanied by a draft of sheet music. Other sheet music and verses in the collection appear to be reference materials. The recordings were also used for research and include well-known compositions such as Homage to Rameau by French composer Claude Debussy, music by Louise Lyon, and experimentation with sound.</p> <p>The autobiographical project is represented through typewritten recollections about Nichols' childhood, her introduction to New York City theater, the development of her early work, and the reception of Abie's Irish Rose. The manuscript drafts communicate Nichols' desire to publish this project through the organization of her recollections with accompanying chapter notes, page numbers, and edits.</p> <p>Additionally, the collection includes letters that pertain to personal matters and the development of a few plays.</p>"}, {'type': 'acqinfo','text': '<p>Donated by Louis Simon, 1974.</p>'}, {'type': 'relatedmaterial','text': '<span class="archref">Anne Nichols papers, 1873-1965. Billy Rose Theatre Division, The New York Public Library for the Performing Arts.</span>'}],'languages': [],'dates': [{'field': 'inclusive','type': false,'value': 1925,'keyDate': false,'point': 'start','encoding': false}, {'field': 'inclusive','type': false,'value': 1955,'keyDate': false,'point': 'end','encoding': false}, {'field': 'exact','type': false,'value': '1925','keyDate': true,'point': false,'encoding': false}],'abstracts': ["Anne Nichols (1891-1966) was an American playwright. The Anne Nichols papers, Additions date from 1925 to 1955 and predominantly document the resurgence of her play Abie's Irish Rose through clippings, photographs, and a few programs. The collection also includes writings, letters, sheet music, and recordings."]}]} // eslint-disable-line

    var r = mapUtils.compareCollectionCallNumberMatch(shouldMatch)
    r.archivesCollections[0].title.should.equal('Anne Nichols papers')

    var r2 = mapUtils.compareCollectionCallNumberMatch(noMatch)
    r2.archivesCollections.length.should.equal(0)
  })
})
